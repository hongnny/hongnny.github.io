"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[1477],{10:n=>{n.exports=JSON.parse('{"blogPosts":[{"id":"beforeunload","metadata":{"permalink":"/blog/beforeunload","editUrl":"https://github.com/jonbenery/weblog/blog/2023-01-30-beforeunload/index.md","source":"@site/blog/2023-01-30-beforeunload/index.md","title":"\u9875\u9762\u79bb\u5f00\u65f6\u963b\u6b62\u9875\u9762\u5237\u65b0","description":"js \u9875\u9762\u79bb\u5f00\u540e\u7684\u63d0\u793a\uff08\u6d4f\u89c8\u5668\u63d0\u793a\u7cfb\u7edf\u53ef\u80fd\u4e0d\u4f1a\u4fdd\u5b58\u60a8\u6240\u505a\u7684\u66f4\u6539\uff09","date":"2023-01-30T00:00:00.000Z","formattedDate":"January 30, 2023","tags":[{"label":"javascript","permalink":"/blog/tags/javascript"}],"readingTime":0.285,"hasTruncateMarker":false,"authors":[{"name":"\u8d75\u9526\u5f6c","title":"coder javascript","url":"https://github.com/endiliey","imageURL":"https://github.com/endiliey.png","key":"jonben"}],"frontMatter":{"slug":"beforeunload","title":"\u9875\u9762\u79bb\u5f00\u65f6\u963b\u6b62\u9875\u9762\u5237\u65b0","authors":"jonben","tags":["javascript"]},"nextItem":{"title":"\u6839\u636e\u65f6\u95f4\u6233\u8ba1\u7b97\u51fa\u5177\u4f53\u65f6\u95f4","permalink":"/blog/computedTime"}},"content":"js \u9875\u9762\u79bb\u5f00\u540e\u7684\u63d0\u793a\uff08\u6d4f\u89c8\u5668\u63d0\u793a\u7cfb\u7edf\u53ef\u80fd\u4e0d\u4f1a\u4fdd\u5b58\u60a8\u6240\u505a\u7684\u66f4\u6539\uff09\\n\\n\u963b\u6b62\u9875\u9762\u52a0\u8f7d\u7684\u4ee3\u7801\u5982\u4e0b\uff1a\\n```js\\nwindow.onbeforeunload = function(e) {\\n  var dialogText = \'Dialog text here\';\\n  e.returnValue = dialogText;\\n  return dialogText;\\n};\\n```"},{"id":"computedTime","metadata":{"permalink":"/blog/computedTime","editUrl":"https://github.com/jonbenery/weblog/blog/2023-01-30-computedTime/index.md","source":"@site/blog/2023-01-30-computedTime/index.md","title":"\u6839\u636e\u65f6\u95f4\u6233\u8ba1\u7b97\u51fa\u5177\u4f53\u65f6\u95f4","description":"\u6839\u636e\u7ed9\u5b9a\u7684\u65f6\u95f4\u6233\u8ba1\u7b97\u51fa\u5177\u4f53\u65f6\u95f4\uff0c\u4ee3\u7801\u5982\u4e0b\uff1a","date":"2023-01-30T00:00:00.000Z","formattedDate":"January 30, 2023","tags":[{"label":"javascript","permalink":"/blog/tags/javascript"}],"readingTime":0.89,"hasTruncateMarker":false,"authors":[{"name":"\u8d75\u9526\u5f6c","title":"coder javascript","url":"https://github.com/endiliey","imageURL":"https://github.com/endiliey.png","key":"jonben"}],"frontMatter":{"slug":"computedTime","title":"\u6839\u636e\u65f6\u95f4\u6233\u8ba1\u7b97\u51fa\u5177\u4f53\u65f6\u95f4","authors":"jonben","tags":["javascript"]},"prevItem":{"title":"\u9875\u9762\u79bb\u5f00\u65f6\u963b\u6b62\u9875\u9762\u5237\u65b0","permalink":"/blog/beforeunload"},"nextItem":{"title":"\u7528css\u65b0\u7279\u6027\u4f18\u5316\u957f\u5217\u8868","permalink":"/blog/contentVisibility"}},"content":"\u6839\u636e\u7ed9\u5b9a\u7684\u65f6\u95f4\u6233\u8ba1\u7b97\u51fa\u5177\u4f53\u65f6\u95f4\uff0c\u4ee3\u7801\u5982\u4e0b\uff1a\\n\\n### \u7b2c\u4e00\u79cd\u8ba1\u7b97\u65b9\u6cd5\\n\\n```js\\nfunction computedTime(time) {\\n  // \u83b7\u53d6\u8f93\u5165\u65f6\u95f4\u4e0e\u4eca\u5929\u65f6\u95f4\u6233\u7684\u5dee\u503c\\n  const duration = new Date().getTime() - time\\n  // \u5929\\n  const d = Math.floor(duration / (24 * 60 * 60 * 1000));\\n  // \u5c0f\u65f6\\n  const h = Math.floor((duration % (24 * 60 * 60 * 1000)) / 3600000);\\n  // \u5206\u949f\\n  const m = Math.floor((duration % (60 * 60 * 1000)) / 60000);\\n  // \u79d2\\n  const s = Math.floor(duration % (60 * 1000) / 1000);\\n\\n  return {\\n    d,\\n    h,\\n    m,\\n    s\\n  }\\n}\\n```\\n\\n### \u7b2c\u4e8c\u79cd\u8ba1\u7b97\u65b9\u6cd5\\n```js\\nfunction computedTime (time) {\\n  const d = Math.floor(time / (24 * 60 * 60 * 1000));\\n  const h = Math.floor(time / 3600000) % 24\\n  const m = Math.floor(time / 60000) % 60\\n  const s = Math.floor(time / 1000) % 60\\n  return {\\n    d,\\n    h,\\n    m,\\n    s\\n  }\\n}\\n```"},{"id":"contentVisibility","metadata":{"permalink":"/blog/contentVisibility","editUrl":"https://github.com/jonbenery/weblog/blog/2023-01-30-contentVisibility/index.mdx","source":"@site/blog/2023-01-30-contentVisibility/index.mdx","title":"\u7528css\u65b0\u7279\u6027\u4f18\u5316\u957f\u5217\u8868","description":"\u5e9f\u8bdd\u4e0d\u591a\u8bf4\uff0c\u8be5\u5c5e\u6027\u4e3a content-visibility","date":"2023-01-30T00:00:00.000Z","formattedDate":"January 30, 2023","tags":[{"label":"javascript","permalink":"/blog/tags/javascript"}],"readingTime":9.555,"hasTruncateMarker":false,"authors":[{"name":"\u8d75\u9526\u5f6c","title":"coder javascript","url":"https://github.com/endiliey","imageURL":"https://github.com/endiliey.png","key":"jonben"}],"frontMatter":{"slug":"contentVisibility","title":"\u7528css\u65b0\u7279\u6027\u4f18\u5316\u957f\u5217\u8868","authors":"jonben","tags":["javascript"]},"prevItem":{"title":"\u6839\u636e\u65f6\u95f4\u6233\u8ba1\u7b97\u51fa\u5177\u4f53\u65f6\u95f4","permalink":"/blog/computedTime"},"nextItem":{"title":"\u62d6\u62fd\u83b7\u53d6\u6587\u4ef6\u5939\u4e0b\u7684\u6240\u6709\u6587\u4ef6","permalink":"/blog/dragDir"}},"content":"\u5e9f\u8bdd\u4e0d\u591a\u8bf4\uff0c\u8be5\u5c5e\u6027\u4e3a `content-visibility`\\n\\n## 1. \u4f55\u4e3a content-visibility\uff1f\\n\\n`content-visibility` \uff1a\u5c5e\u6027\u63a7\u5236\u4e00\u4e2a\u5143\u7d20\u662f\u5426\u6e32\u67d3\u5176\u5185\u5bb9\uff0c\u5b83\u5141\u8bb8\u7528\u6237\u4ee3\u7406\uff08\u6d4f\u89c8\u5668\uff09\u6f5c\u5728\u5730\u7701\u7565\u5927\u91cf\u5e03\u5c40\u548c\u6e32\u67d3\u5de5\u4f5c\uff0c\u76f4\u5230\u9700\u8981\u5b83\u4e3a\u6b62\u3002\\n:::info MDN \u539f\u6587\\nThe content-visibility CSS property controls whether or not an element renders its contents at all, along with forcing a strong set of containments, allowing user agents to potentially omit large swathes of layout and rendering work until it becomes needed. Basically it enables the user agent to skip an element\'s rendering work (including layout and painting) until it is needed \u2014 which makes the initial page load much faster.\\n:::\\n\\n\u5b83\u6709\u51e0\u4e2a\u5e38\u89c1\u7684\u53d6\u503c\u3002\\n```CSS\\ncontent-visibility: visible;\\ncontent-visibility: hidden;\\ncontent-visibility: auto;\\n```\\n\\n\u5206\u522b\u89e3\u91ca\u4e00\u4e0b\uff1a\\n* `content-visibility: visible` \uff1a\u9ed8\u8ba4\u503c\uff0c\u6ca1\u6709\u4efb\u4f55\u6548\u679c\uff0c\u76f8\u5f53\u4e8e\u6ca1\u6709\u6dfb\u52a0 `content-visibility`\uff0c\u5143\u7d20\u7684\u6e32\u67d3\u4e0e\u5f80\u5e38\u4e00\u81f4\u3002\\n* `content-visibility: hidden` \uff1a\u4e0e `display: none` \u7c7b\u4f3c\uff0c\u7528\u6237\u4ee3\u7406\u5c06\u8df3\u8fc7\u5176\u5185\u5bb9\u7684\u6e32\u67d3\u3002\uff08\u8fd9\u91cc\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u8df3\u8fc7\u7684\u662f\u5185\u5bb9\u7684\u6e32\u67d3\uff09\\n* `content-visibility: auto` \uff1a\u5982\u679c\u8be5\u5143\u7d20\u4e0d\u5728\u5c4f\u5e55\u4e0a\uff0c\u5e76\u4e14\u4e0e\u7528\u6237\u65e0\u5173\uff0c\u5219\u4e0d\u4f1a\u6e32\u67d3\u5176\u540e\u4ee3\u5143\u7d20\u3002\\n\\n## 2. contain-intrinsic-size\\n\\n\u5f53\u7136\uff0c\u9664 `content-visibility` \u4e4b\u5916\uff0c\u8fd8\u6709\u4e00\u4e2a\u4e0e\u4e4b\u914d\u5957\u7684\u5c5e\u6027 `contain-intrinsic-size`\u3002\\n\\n`contain-intrinsic-size` \uff1a\u63a7\u5236\u7531 `content-visibility` \u6307\u5b9a\u7684\u5143\u7d20\u7684\u81ea\u7136\u5927\u5c0f\u3002\\n\\n## 3. \u5229\u7528 content-visibility: hidden \u4f18\u5316\u5c55\u793a\u5207\u6362\u6027\u80fd\\n\\n\u9996\u5148\uff0c\u5047\u8bbe\u6211\u4eec\u6709\u4e24\u4e2a DIV \u5305\u88f9\u6846\uff1a\\n\\n```html\\n<div class=\\"g-wrap\\">\\n  <div>1111</div>\\n  <div class=\\"hidden\\">2222</div>\\n</div>\\n```\\n\u8bbe\u7f6e\u4e24\u4e2a div \u4e3a 200x200 \u7684\u9ed1\u8272\u5757\uff1a\\n```CSS\\n.g-wrap > div {\\n  width: 60px;\\n  height: 60px;\\n  background: #000;\\n}\\n```\\n\\nimport { RenderHtml } from \'./index.js\'\\n\\n\u6548\u679c\u5982\u4e0b\uff1a\\n\\n<RenderHtml/>\\n\\nOK\uff0c\u6ca1\u6709\u95ee\u9898\uff0c\u63a5\u4e0b\u6765\uff0c\u6211\u4eec\u7ed9\u5176\u4e2d\u7684 `.hidden` \u8bbe\u7f6e `content-visibility: hidden`\uff0c\u770b\u770b\u4f1a\u53d1\u751f\u4ec0\u4e48\uff1a\\n```CSS\\n.hidden {\\n  content-visibility: hidden;\\n}\\n```\\n\u6548\u679c\u5982\u4e0b\uff1a\\n\\n<RenderHtml hidden=\\"hidden\\"/>\\n\\n\u6ce8\u610f\uff0c\u4ed4\u7ec6\u770b\u6548\u679c\uff0c\u8fd9\u91cc\u6dfb\u52a0\u4e86 `content-visibility: hidden` \u4e4b\u540e\uff0c**\u6d88\u5931\u7684\u53ea\u662f\u6dfb\u52a0\u4e86\u8be5\u5143\u7d20\u7684 `div` \u7684\u5b50\u5143\u7d20\u6d88\u5931\u4e0d\u89c1\uff0c\u800c\u7236\u5143\u7d20\u672c\u8eab\u53ca\u5176\u6837\u5f0f\uff0c\u8fd8\u662f\u5b58\u5728\u9875\u9762\u4e0a\u7684\u3002**\\n\\n\u5982\u679c\u6211\u4eec\u53bb\u6389\u8bbe\u7f6e\u4e86 `content-visibility: hidden` \u7684\u5143\u7d20\u672c\u8eab\u7684 `width`\u3001`height`\u3001`padding`\u3001`margin` \u7b49\u5c5e\u6027\uff0c\u5219\u5143\u7d20\u770b\u4e0a\u53bb\u5c31\u5982\u540c\u8bbe\u7f6e\u4e86 `display: none` \u4e00\u822c\uff0c\u5728\u9875\u9762\u4e0a\u6d88\u5931\u4e0d\u89c1\u4e86\u3002\\n\\n\u90a3\u4e48\uff0c`content-visibility: hidden` \u7684\u4f5c\u7528\u662f\u4ec0\u4e48\u5462\uff1f\\n\\n\u8bbe\u7f6e\u4e86 `content-visibility: hidden` \u7684\u5143\u7d20\uff0c**\u5176\u5143\u7d20\u7684\u5b50\u5143\u7d20\u5c06\u88ab\u9690\u85cf\uff0c\u4f46\u662f\uff0c\u5b83\u7684\u6e32\u67d3\u72b6\u6001\u5c06\u4f1a\u88ab\u7f13\u5b58**\u3002\u6240\u4ee5\uff0c\u5f53 `content-visibility: hidden` \u88ab\u79fb\u9664\u65f6\uff0c\u7528\u6237\u4ee3\u7406\u65e0\u9700\u91cd\u5934\u5f00\u59cb\u6e32\u67d3\u5b83\u548c\u5b83\u7684\u5b50\u5143\u7d20\u3002\\n\\n\u56e0\u6b64\uff0c\u5982\u679c\u6211\u4eec\u5c06\u8fd9\u4e2a\u5c5e\u6027\u5e94\u7528\u5728\u4e00\u4e9b\u4e00\u5f00\u59cb\u9700\u8981\u88ab\u9690\u85cf\uff0c\u4f46\u662f\u5176\u540e\u5728\u9875\u9762\u7684\u67d0\u4e00\u65f6\u523b\u9700\u8981\u88ab\u6e32\u67d3\uff0c\u6216\u8005\u662f\u4e00\u4e9b\u9700\u8981\u88ab\u9891\u7e41\u5207\u6362\u663e\u793a\u3001\u9690\u85cf\u72b6\u6001\u7684\u5143\u7d20\u4e0a\uff0c\u5176\u6e32\u67d3\u6548\u7387\u5c06\u4f1a\u6709\u4e00\u4e2a\u975e\u5e38\u5927\u7684\u63d0\u5347\u3002\\n\\n## 4. \u5229\u7528 content-visibility: auto \u5b9e\u73b0\u61d2\u52a0\u8f7d\u6216\u865a\u62df\u5217\u8868\\n\\nOK\uff0c\u63a5\u4e0b\u6765\u662f `content-visibility` \u7684\u6838\u5fc3\u7528\u6cd5\uff0c\u5229\u7528 `auto` \u5c5e\u6027\u503c\u3002\\n\\n`content-visibility: auto` \u7684\u4f5c\u7528\u662f\uff0c\u5982\u679c\u8be5\u5143\u7d20\u4e0d\u5728\u5c4f\u5e55\u4e0a\uff0c\u5e76\u4e14\u4e0e\u7528\u6237\u65e0\u5173\uff0c\u5219\u4e0d\u4f1a\u6e32\u67d3\u5176\u540e\u4ee3\u5143\u7d20\u3002\u662f\u4e0d\u662f\u4e0e `LazyLoad` \u975e\u5e38\u7c7b\u4f3c\u3002\\n\\n\u6211\u4eec\u6765\u770b\u8fd9\u6837\u4e00\u4e2a DEMO \uff0c\u4e86\u89e3\u5176\u4f5c\u7528\uff1a\\n\\n\u5047\u8bbe\uff0c\u6211\u4eec\u5b58\u5728\u8fd9\u6837\u4e00\u4e2a HTML \u7ed3\u6784\uff0c\u542b\u6709\u5927\u91cf\u7684\u6587\u672c\u5185\u5bb9\uff1a\\n\\n```HTML\\n<div class=\\"g-wrap\\">\\n    <div class=\\"paragraph\\">...</div>\\n    // ... \u5305\u542b\u4e86 N \u4e2a paragraph\\n    <div class=\\"paragraph\\">...</div>\\n</div>\\n```\\n\u6bcf\u4e2a `.paragraph` \u7684\u5185\u5bb9\u5982\u4e0b\\n```HTML\\nLorem Start!\\nLorem ipsum dolor sit amet consectetur adipisicing elit.Nonvitae voluptates maxime solutaimpedit doloremque atque quasi dignissimosdelectus distinctio aut commodieaque nostrum maiores nulla! Ipsum voluptatibus alias suscipit!\\nLorem ipsum dolor sit amet consectetur adipisicingelit.Non vitae voluptates maxime solutaimpedit doloremque atque quasi dignissimos,delectus distinctio aut commodi eaque nostrum maiores nulla! Ipsum voluptatibus alias suscipit!\\nLorem End!\\n```\\n\\n\u56e0\u6b64\uff0c\u6574\u4e2a\u7684\u9875\u9762\u770b\u8d77\u6765\u5c31\u662f\u8fd9\u6837\u7684\uff1a\\n\\nimport { RenderImg } from \'../../src/common/index.js\';\\n\\n<RenderImg\\n  width=\\"600px\\"\\n  src=\\"../../img/web/content.visibility.1.gif\\"/>\\n\\n\u7531\u4e8e\uff0c\u6211\u4eec\u6ca1\u6709\u5bf9\u9875\u9762\u5185\u5bb9\u8fdb\u884c\u4efb\u4f55\u5904\u7406\uff0c\u56e0\u6b64\uff0c\u6240\u6709\u7684 `.paragraph` \u5728\u9875\u9762\u5237\u65b0\u7684\u4e00\u77ac\u95f4\uff0c\u90fd\u4f1a\u8fdb\u884c\u6e32\u67d3\uff0c\u770b\u5230\u7684\u6548\u679c\u5c31\u5982\u4e0a\u6240\u793a\u3002\\n\\n\u5f53\u7136\uff0c\u73b0\u4ee3\u6d4f\u89c8\u5668\u6108\u52a0\u8d8b\u4e8e\u667a\u80fd\uff0c\u57fa\u4e8e\u8fd9\u79cd\u573a\u666f\uff0c\u5176\u5b9e\u6211\u4eec\u975e\u5e38\u5e0c\u671b\u5bf9\u4e8e\u4ecd\u672a\u770b\u5230\uff0c\u4ecd\u65e7\u672a\u6eda\u52a8\u5230\u7684\u533a\u57df\uff0c\u53ef\u4ee5\u5ef6\u8fdf\u52a0\u8f7d\uff0c\u53ea\u6709\u5230\u6211\u4eec\u9700\u8981\u5c55\u793a\u3001\u6eda\u52a8\u5230\u8be5\u5904\u65f6\uff0c\u9875\u9762\u5185\u5bb9\u624d\u8fdb\u884c\u6e32\u67d3\u3002\\n\\n\u57fa\u4e8e\u8fd9\u79cd\u573a\u666f\uff0c`content-visibility: auto` \u5c31\u5e94\u8fd0\u800c\u751f\u4e86\uff0c\u5b83\u5141\u8bb8\u6d4f\u89c8\u5668\u5bf9\u4e8e\u8bbe\u7f6e\u4e86\u8be5\u5c5e\u6027\u7684\u5143\u7d20\u8fdb\u884c\u5224\u65ad\uff0c\u5982\u679c\u8be5\u5143\u7d20\u5f53\u524d\u4e0d\u5904\u4e8e\u89c6\u53e3\u5185\uff0c\u5219\u4e0d\u6e32\u67d3\u8be5\u5143\u7d20\u3002\\n\\n\u6211\u4eec\u57fa\u4e8e\u4e0a\u8ff0\u7684\u4ee3\u7801\uff0c\u53ea\u9700\u8981\u6700\u5c0f\u5316\uff0c\u6dfb\u52a0\u8fd9\u6837\u4e00\u6bb5\u4ee3\u7801\uff1a\\n```CSS\\n.paragraph {\\n  content-visibility: auto;\\n}\\n```\\n\u518d\u770b\u770b\u6548\u679c\uff0c\u4ed4\u7ec6\u89c2\u5bdf\u53f3\u4fa7\u7684\u6eda\u52a8\u6761\uff1a\\n\\n<RenderImg\\n  width=\\"600px\\"\\n  src=\\"../../img/web/content.visibility.2.png\\"/>\\n\\n\u53ef\u80fd\u4f60\u8fd8\u6ca1\u610f\u8bc6\u5230\u53d1\u751f\u4e86\u4ec0\u4e48\uff0c\u6211\u4eec\u5bf9\u6bd4\u4e0b\u6dfb\u52a0\u4e86 `content-visibility: auto` \u548c\u6ca1\u6709\u6dfb\u52a0 `content-visibility: auto` \u7684\u4e24\u79cd\u6548\u679c\u4e0b\u6587\u672c\u7684\u6574\u4f53\u9ad8\u5ea6\uff1a\\n\\n<RenderImg\\n  width=\\"600px\\"\\n  src=\\"../../img/web/content.visibility.3.png\\"/>\\n\\n\u6709\u7740\u975e\u5e38\u660e\u663e\u7684\u5dee\u5f02\uff0c\u8fd9\u662f\u56e0\u4e3a\uff0c\u8bbe\u7f6e\u4e86 `content-visibility: auto` \u7684\u5143\u7d20\uff0c\u5728\u975e\u53ef\u89c6\u533a\u57df\u5185\uff0c\u76ee\u524d\u5e76\u6ca1\u6709\u88ab\u6e32\u67d3\uff0c\u56e0\u6b64\uff0c\u53f3\u4fa7\u5185\u5bb9\u7684\u9ad8\u5ea6\u5176\u5b9e\u662f\u6bd4\u6b63\u5e38\u72b6\u6001\u4e0b\u5c11\u4e86\u4e00\u5927\u622a\u7684\u3002\\n\\n\u6211\u4eec\u5b9e\u9645\u5f00\u59cb\u8fdb\u884c\u6eda\u52a8\uff0c\u770b\u770b\u4f1a\u53d1\u751f\u4ec0\u4e48\uff1a\\n\\n<RenderImg\\n  width=\\"600px\\"\\n  src=\\"../../img/web/content.visibility.4.gif\\"/>\\n\\n\u7531\u4e8e\u4e0b\u65b9\u7684\u5143\u7d20\u5728\u6eda\u52a8\u7684\u8fc7\u7a0b\u4e2d\uff0c\u51fa\u73b0\u5728\u89c6\u53e3\u8303\u56f4\u5185\u624d\u88ab\u6e32\u67d3\uff0c\u56e0\u6b64\uff0c\u6eda\u52a8\u6761\u51fa\u73b0\u4e86\u660e\u663e\u7684\u98d8\u5ffd\u4e0d\u5b9a\u7684\u6296\u52a8\u73b0\u8c61\u3002\uff08\u5f53\u7136\u8fd9\u4e5f\u662f\u4f7f\u7528\u4e86 `content-visibility: auto` \u7684\u4e00\u4e2a\u5c0f\u95ee\u9898\u4e4b\u4e00\uff09\uff0c\u4e0d\u8fc7\u660e\u663e\u53ef\u4ee5\u770b\u51fa\uff0c\u8fd9\u4e0e\u6211\u4eec\u901a\u5e38\u4f7f\u7528 JavaScript \u5b9e\u73b0\u7684\u61d2\u52a0\u8f7d\u6216\u8005\u5ef6\u8fdf\u52a0\u8f7d\u975e\u5e38\u7c7b\u4f3c\u3002\\n\\n\u5f53\u7136\uff0c\u4e0e\u61d2\u52a0\u8f7d\u4e0d\u540c\u7684\u662f\uff0c\u5728\u5411\u4e0b\u6eda\u52a8\u7684\u8fc7\u7a0b\u4e2d\uff0c\u4e0a\u65b9\u6d88\u5931\u7684\u5df2\u7ecf\u88ab\u6e32\u67d3\u8fc7\u4e14\u6d88\u5931\u5728\u89c6\u53e3\u7684\u5143\u7d20\uff0c\u4e5f\u4f1a\u56e0\u4e3a\u6d88\u5931\u5728\u89c6\u53e3\u4e2d\uff0c\u91cd\u65b0\u88ab\u9690\u85cf\u3002\u56e0\u6b64\uff0c\u5373\u4fbf\u9875\u9762\u6eda\u52a8\u5230\u6700\u4e0b\u65b9\uff0c\u6574\u4f53\u7684\u6eda\u52a8\u6761\u9ad8\u5ea6\u8fd8\u662f\u6ca1\u6709\u4ec0\u4e48\u53d8\u5316\u7684\u3002\\n\\n\\n## 5. \u5229\u7528 contain-intrinsic-size \u89e3\u51b3\u6eda\u52a8\u6761\u6296\u52a8\u95ee\u9898\\n\\n\u4ece\u4e0a\u9762\u7684\u4f8b\u5b50\uff0c\u4e5f\u80fd\u770b\u5230\uff0c\u5728\u5229\u7528 `content-visibility: auto` \u5904\u7406\u957f\u6587\u672c\u3001\u957f\u5217\u8868\u7684\u65f6\u5019\u3002\u5728\u6eda\u52a8\u9875\u9762\u7684\u8fc7\u7a0b\u4e2d\uff0c\u6eda\u52a8\u6761\u4e00\u76f4\u5728\u6296\u52a8\uff0c\u8fd9\u4e0d\u662f\u4e00\u4e2a\u5f88\u597d\u7684\u4f53\u9a8c\u3002\\n\\n\u597d\u5728\uff0c\u89c4\u8303\u5236\u5b9a\u8005\u4e5f\u53d1\u73b0\u4e86\u8fd9\u4e2a\u95ee\u9898\u3002\u8fd9\u91cc\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u53e6\u5916\u4e00\u4e2a `CSS` \u5c5e\u6027\uff0c\u4e5f\u5c31\u662f\u6587\u7ae0\u4e00\u5f00\u5934\u63d0\u5230\u7684\u53e6\u5916\u4e00\u4e2a\u5c5e\u6027 `contain-intrinsic-size` \u6765\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\u3002\\n\\n:::info MDN\\n`contain-intrinsic-size` \uff1a\u63a7\u5236\u7531 `content-visibility` \u6307\u5b9a\u7684\u5143\u7d20\u7684\u81ea\u7136\u5927\u5c0f\u3002\\n:::\\n\\n\u4ec0\u4e48\u610f\u601d\u5462\uff1f\u8fd8\u662f\u4e0a\u9762\u7684\u4f8b\u5b50\\n```HTML\\n<div class=\\"g-wrap\\">\\n  <div class=\\"paragraph\\">...</div>\\n  // ... \u5305\u542b\u4e86 N \u4e2a paragraph\\n  <div class=\\"paragraph\\">...</div>\\n</div>\\n```\\n\u5982\u679c\u6211\u4eec\u4e0d\u4f7f\u7528 `contain-intrinsic-size`\uff0c\u53ea\u5bf9\u89c6\u53e3\u4e4b\u5916\u7684\u5143\u7d20\u4f7f\u7528 `content-visibility: auto`\uff0c\u90a3\u4e48\u89c6\u53e3\u5916\u7684\u5143\u7d20\u9ad8\u5ea6\u901a\u5e38\u5c31\u4e3a 0\u3002\u5bfc\u81f4\u5b9e\u9645\u7684\u6eda\u52a8\u6548\u679c\uff0c\u6eda\u52a8\u6761\u5c31\u662f\u6296\u52a8\u7684\u3002\\n\\n\u6240\u4ee5\uff0c\u6211\u4eec\u53ef\u4ee5\u540c\u65f6\u5229\u7528\u4e0a `contain-intrinsic-size`\uff0c\u5982\u679c\u80fd\u51c6\u786e\u77e5\u9053\u8bbe\u7f6e\u4e86 `content-visibility: auto` \u7684\u5143\u7d20\u5728\u6e32\u67d3\u72b6\u6001\u4e0b\u7684\u9ad8\u5ea6\uff0c\u5c31\u586b\u5199\u5bf9\u5e94\u7684\u9ad8\u5ea6\u3002\u5982\u679c\u5982\u6cd5\u51c6\u786e\u77e5\u9053\u9ad8\u5ea6\uff0c\u4e5f\u53ef\u4ee5\u586b\u5199\u4e00\u4e2a\u5927\u6982\u7684\u503c\uff1a\\n\\n```CSS\\n.paragraph {\\n  content-visibility: auto;\\n  contain-intrinsic-size: 320px;\\n}\\n```\\n\u5982\u6b64\u4e4b\u540e\uff0c\u6d4f\u89c8\u5668\u4f1a\u7ed9\u672a\u88ab\u5b9e\u9645\u6e32\u67d3\u7684\u89c6\u53e3\u4e4b\u5916\u7684 `.paragraph` \u5143\u7d20\u4e00\u4e2a\u9ad8\u5ea6\uff0c\u907f\u514d\u51fa\u73b0\u6eda\u52a8\u6761\u6296\u52a8\u7684\u73b0\u8c61\uff1a\\n\\n<RenderImg\\n  width=\\"600px\\"\\n  src=\\"../../img/web/content.visibility.5.gif\\"/>\\n\\n## 6.content-visibility \u7684\u4e00\u4e9b\u5176\u4ed6\u95ee\u9898\\n\\n\u76ee\u524d\u517c\u5bb9\u6027\u8fd8\u662f\u6bd4\u8f83\u60e8\u6de1\u7684\uff0c\u9700\u8981\u518d\u7b49\u5f85\u4e00\u6bb5\u65f6\u95f4\u3002\u5f53\u7136\uff0c\u7531\u4e8e\u8be5\u5c5e\u6027\u5c5e\u4e8e\u6e10\u8fdb\u589e\u5f3a\u4e00\u7c7b\u7684\u529f\u80fd\uff0c\u5373\u4fbf\u5931\u6548\uff0c\u4e5f\u5b8c\u5168\u4e0d\u5f71\u54cd\u9875\u9762\u672c\u8eab\u7684\u5c55\u793a\u3002\\n\u540c\u65f6\uff0c\u4e5f\u6709\u4e00\u4e9b\u540c\u5b66\u8868\u793a\uff0c\u5229\u7528 `content-visibility: auto` \u53ea\u80fd\u89e3\u51b3\u90e8\u5206\u573a\u666f\uff0c\u5728\u6d77\u91cf DOM \u7684\u573a\u666f\u4e0b\u7684\u5b9e\u9645\u6548\u679c\uff0c\u8fd8\u6709\u5f85\u8fdb\u4e00\u6b65\u7684\u5b9e\u6d4b\u3002\u771f\u6b63\u8fd0\u7528\u7684\u65f6\u5019\uff0c\u591a\u505a\u5bf9\u6bd4\uff0c\u518d\u505a\u53d6\u820d\u3002\\n\u5f53\u7136\uff0c\u73b0\u4ee3\u6d4f\u89c8\u5668\u5df2\u7ecf\u8d8a\u6765\u8d8a\u667a\u80fd\uff0c\u7c7b\u4f3c `content-visibility` \u529f\u80fd\u7684\u5c5e\u6027\u4e5f\u8d8a\u6765\u8d8a\u591a\uff0c\u6211\u4eec\u5728\u6027\u80fd\u4f18\u5316\u7684\u8def\u4e0a\u6709\u4e86\u66f4\u591a\u9009\u62e9\uff0c\u603b\u5f52\u662f\u4e00\u4ef6\u597d\u4e8b\u3002"},{"id":"dragDir","metadata":{"permalink":"/blog/dragDir","editUrl":"https://github.com/jonbenery/weblog/blog/2023-01-30-dragDir/index.mdx","source":"@site/blog/2023-01-30-dragDir/index.mdx","title":"\u62d6\u62fd\u83b7\u53d6\u6587\u4ef6\u5939\u4e0b\u7684\u6240\u6709\u6587\u4ef6","description":"1. \u9996\u5148\u6211\u4eec\u6765\u8ba4\u8bc6\u4e00\u4e0b\u5173\u4e8e\u6587\u4ef6\u7684\u4e00\u4e9bapi","date":"2023-01-30T00:00:00.000Z","formattedDate":"January 30, 2023","tags":[{"label":"javascript","permalink":"/blog/tags/javascript"}],"readingTime":2.14,"hasTruncateMarker":false,"authors":[{"name":"\u8d75\u9526\u5f6c","title":"coder javascript","url":"https://github.com/endiliey","imageURL":"https://github.com/endiliey.png","key":"jonben"}],"frontMatter":{"slug":"dragDir","title":"\u62d6\u62fd\u83b7\u53d6\u6587\u4ef6\u5939\u4e0b\u7684\u6240\u6709\u6587\u4ef6","authors":"jonben","tags":["javascript"]},"prevItem":{"title":"\u7528css\u65b0\u7279\u6027\u4f18\u5316\u957f\u5217\u8868","permalink":"/blog/contentVisibility"},"nextItem":{"title":"\u591a\u5c42\u7ea7\u5143\u7d20\u62d6\u653e","permalink":"/blog/elementDrag"}},"content":"import DragDirectory from \'./index.js\'\\n\\n## 1. \u9996\u5148\u6211\u4eec\u6765\u8ba4\u8bc6\u4e00\u4e0b\u5173\u4e8e\u6587\u4ef6\u7684\u4e00\u4e9bapi\\n\\n\uff08\u4ee5\u4e0b\u5185\u5bb9\u5f15\u7528\u81f3MDN\uff09\\n\\n### [DataTransferItem.webkitGetAsEntry()](https://developer.mozilla.org/zh-CN/docs/Web/API/DataTransferItem/webkitGetAsEntry)\\n\\n\u5982\u679c\u7531\u6587\u4ef6\u63cf\u8ff0\u7684\u9879\u76eeDataTransferItem\u662f\u6587\u4ef6\uff0c\u5219webkitGetAsEntry()\u8fd4\u56deFileSystemFileEntry\u6216FileSystemDirectoryEntry\u8868\u793a\u5b83\u3002\u5982\u679c\u8be5\u9879\u4e0d\u662f\u6587\u4ef6\uff0cnull\u5219\u8fd4\u56de\u3002\\n\\n### [FileSystemFileEntry](https://developer.mozilla.org/zh-CN/docs/Web/API/FileSystemFileEntry)\\n\\n\u6587\u4ef6\u7cfb\u7edf API \u7684 FileSystemFileEntry \u63a5\u53e3\u8868\u793a\u6587\u4ef6\u7cfb\u7edf\u4e2d\u7684\u6587\u4ef6\u3002\u5b83\u63d0\u4f9b\u4e86\u5c5e\u6027\uff0c\u63cf\u8ff0\u6587\u4ef6\u7684\u5c5e\u6027\uff0c\u4ee5\u53ca file() (en-US) \u65b9\u6cd5\uff0c\u5b83\u521b\u5efa\u4e86\u53ef\u4ee5\u7528\u4e8e\u8bfb\u53d6\u6587\u4ef6\u7684 File \u5bf9\u8c61\u3002\\n\\n### [FileSystemDirectoryEntry](https://developer.mozilla.org/zh-CN/docs/Web/API/FileSystemDirectoryEntry)\\n\\n\u6587\u4ef6\u548c\u76ee\u5f55\u6761\u76ee API \u7684 FileSystemDirectoryEntry \u63a5\u53e3\u8868\u793a\u6587\u4ef6\u7cfb\u7edf\u4e2d\u7684\u76ee\u5f55\u3002\u5b83\u63d0\u4f9b\u4e86\u65b9\u6cd5\uff0c\u4f7f\u5176\u80fd\u591f\u8bbf\u95ee\u548c\u64cd\u4f5c\u76ee\u5f55\u4e2d\u7684\u6587\u4ef6\uff0c\u4ee5\u53ca\u8bbf\u95ee\u76ee\u5f55\u4e2d\u7684\u6761\u76ee\u3002\\n\\n## 2. \u63a5\u4e0b\u6765\u6211\u4eec\u7f16\u5199\u4ee3\u7801\\n\\n```html\\n<div id=\\"area\\"></div>\\n```\\n```css\\n #area {\\n    width: 200px;\\n    height: 200px;\\n    border: 1px solid red;\\n  }\\n```\\n```js\\nconst area = document.getElementById(\'area\');\\n\\narea.ondragover = (e) => {\\n  e.preventDefault();\\n};\\n\\narea.ondragleave = (e) => {\\n  e.preventDefault();\\n};\\n\\narea.ondrop = function(evt) {\\n  evt.preventDefault();\\n  evt.stopPropagation();\\n  const items = evt.dataTransfer.items;\\n  if (items.length > 1) {\\n    return console.log(\\"\u4e00\u6b21\u53ea\u5141\u8bb8\u4e0a\u4f20\u4e00\u4e2a\u6587\u4ef6\u5939\\");\\n  }\\n  const item = items[0].webkitGetAsEntry();\\n  if (item && item.isDirectory) {\\n    traverseFileTree(item).then(res => {\\n      console.log(res);\\n    });\\n  }\\n}\\n\\n// \u5206\u6790\u6587\u4ef6\u5939\u4e0b\u7684\u6587\u4ef6\\nfunction traverseFileTree(item) {\\n  return new Promise((resolve, reject) => {\\n    let res = [];\\n    let timer;\\n    const internalProces = (item, path, res) => {\\n      if (item.isFile) {\\n        item.file(file => {\\n          file.path = path + file.name;\\n          const newFile = new File([file], file.path, { type: file.type });\\n          res.push(newFile);\\n          timer = setTimeout(() => {\\n            resolve(res);\\n          }, 600);\\n        });\\n      } else if (item.isDirectory) {\\n        clearTimeout(timer);\\n        const dirReader = item.createReader();\\n        dirReader.readEntries(entries => {\\n          for (let i = 0; i < entries.length; i++) {\\n            internalProces(entries[i], path + item.name + \\"/\\", res);\\n          }\\n        }, (error) => reject(error));\\n      }\\n    };\\n    internalProces(item, \\"\\", res);\\n  })\\n}\\n```\\n\\n## \u8bd5\u4e00\u8bd5\u5427\\n<DragDirectory />\\n\\n## 3. \u5f53\u7136\u6211\u4eec\u53ef\u4ee5\u5229\u7528input\u7684\u539f\u751f\u4e8b\u4ef6\u6765\u83b7\u53d6\u6587\u4ef6\u5939\u5185\u7684\u5185\u5bb9\\n\\n```html\\n<input type=\\"file\\" webkitdirectory id=\\"ipt\\"/>\\n```\\n\\n```js\\nconst ipt = document.getElementById(\'ipt\')\\nipt.onchange = function(e) {\\n  console.log(ipt.files);\\n}\\n```"},{"id":"elementDrag","metadata":{"permalink":"/blog/elementDrag","editUrl":"https://github.com/jonbenery/weblog/blog/2023-01-30-elementDrag/index.md","source":"@site/blog/2023-01-30-elementDrag/index.md","title":"\u591a\u5c42\u7ea7\u5143\u7d20\u62d6\u653e","description":"\u6b63\u5e38\u62d6\u62fd\u6587\u4ef6\u5230\u6307\u5b9a\u5bb9\u5668\u65f6\uff0c\u5982\u679c\u5bb9\u5668\u5185\u90e8\u6ca1\u6709\u5143\u7d20\uff0c\u53ef\u4ee5\u6b63\u5e38\u54cd\u5e94enter\u548cleave\u4e8b\u4ef6\uff0c\u5982\u679c\u5185\u90e8\u5177\u6709\u5143\u7d20\uff0c\u867d\u7136\u53ea\u662f\u5728\u7236\u7ea7\u522b\u5bb9\u5668\u65f6\u6dfb\u52a0\u7684\u4e8b\u4ef6\uff0c\u4f9d\u7136\u4f1a\u5bfc\u81f4\u5b50\u5143\u7d20\u8bef\u89e6\u53d1\uff0c\u5728\u62d6\u62fd\u65f6\u4f1a\u9891\u7e41\u51fa\u73b0ondragenter\u548condragleave\u4e8b\u4ef6\uff0c\u539f\u56e0\u662f\u5192\u6ce1\u5bfc\u81f4\u3002","date":"2023-01-30T00:00:00.000Z","formattedDate":"January 30, 2023","tags":[{"label":"javascript","permalink":"/blog/tags/javascript"}],"readingTime":1.465,"hasTruncateMarker":false,"authors":[{"name":"\u8d75\u9526\u5f6c","title":"coder javascript","url":"https://github.com/endiliey","imageURL":"https://github.com/endiliey.png","key":"jonben"}],"frontMatter":{"slug":"elementDrag","title":"\u591a\u5c42\u7ea7\u5143\u7d20\u62d6\u653e","authors":"jonben","tags":["javascript"]},"prevItem":{"title":"\u62d6\u62fd\u83b7\u53d6\u6587\u4ef6\u5939\u4e0b\u7684\u6240\u6709\u6587\u4ef6","permalink":"/blog/dragDir"},"nextItem":{"title":"\u524d\u7aef\u6587\u4ef6\u4e0b\u8f7d\u7684\u65b9\u5f0f","permalink":"/blog/fileDownload"}},"content":"\u6b63\u5e38\u62d6\u62fd\u6587\u4ef6\u5230\u6307\u5b9a\u5bb9\u5668\u65f6\uff0c\u5982\u679c\u5bb9\u5668\u5185\u90e8\u6ca1\u6709\u5143\u7d20\uff0c\u53ef\u4ee5\u6b63\u5e38\u54cd\u5e94enter\u548cleave\u4e8b\u4ef6\uff0c\u5982\u679c\u5185\u90e8\u5177\u6709\u5143\u7d20\uff0c\u867d\u7136\u53ea\u662f\u5728\u7236\u7ea7\u522b\u5bb9\u5668\u65f6\u6dfb\u52a0\u7684\u4e8b\u4ef6\uff0c\u4f9d\u7136\u4f1a\u5bfc\u81f4\u5b50\u5143\u7d20\u8bef\u89e6\u53d1\uff0c\u5728\u62d6\u62fd\u65f6\u4f1a\u9891\u7e41\u51fa\u73b0ondragenter\u548condragleave\u4e8b\u4ef6\uff0c\u539f\u56e0\u662f\u5192\u6ce1\u5bfc\u81f4\u3002\\n\\n```html\\n<li class=\\"box\\"\\n    ondragenter=\\"handledragenter()\\"\\n    ondragleave=\\"handledragleave()\\"\\n    ondrop=\\"drop\\">\\n  <span>\u5185\u90e8\u76d2\u5b501\\n    <i>\u5185\u90e8\u76d2\u5b502</i>\\n  </span>\\n</li>\\n```\\n\\n```javascript\\nfunction handledragenter() {\\n  console.log(\'\u8fdb\u5165\');\\n}\\nfunction handledragleave() {\\n  console.log(\'\u79bb\u5f00\');\\n}\\n```\\n\u4ece\u5916\u90e8\u79fb\u52a8\u5230\u5185\u90e8\uff0c\u4e8b\u4ef6\u89e6\u53d1\u987a\u5e8f\u5982\u4e0b:\\n- enter parent\\n- enter child\\n- leave parent\\n- enter sub-child\\n- leave child\\n\\n\u6293\u53d6\u5143\u7d20\u62d6\u62fd\u5230\u5bb9\u5668\u5185\u65f6\uff0c\u89e6\u53d1\u987a\u5e8f\u662f\u5148enter\u4e0b\u4e00\u4e2a\uff0c\u518dleave\u4e0a\u4e00\u4e2a\uff0c\u56e0\u6b64\u4e00\u4e2a\u5bb9\u5668\u5185\uff0c\u89e6\u53d1\u5b50\u5143\u7d20\uff0c\u5224\u65ad\u5947\u6570\u548c\u5076\u6570\u5373\u53ef\u8fc7\u6ee4\u6389\u5185\u90e8\u7684\u8bef\u5224\u65ad\uff0c\u53d6\u4e00\u4e2a\u53d8\u91cf\uff0c\u5728enter\u548cleave\u65f6\u90fd\u9012\u589e\uff0c\u4e4b\u540e\u5224\u65ad\u662f\u5947\u6570\u8fd8\u662f\u5076\u6570\u6765\u51b3\u5b9a\u662f\u5426\u89e6\u53d1\u4e8b\u4ef6\uff0c\u6700\u540e\u4e00\u6b21leave\u540e\u5c06\u53d8\u91cf\u91cd\u7f6e\u4e3a0\uff1b\\n\\n\u6539\u8fdb\uff1a\\n```javascript\\nlet count = 0\\nfunction handledragenter() {\\n  count++\\n  if (count % 2) {\\n    console.log(\'\u8fdb\u5165\', count);\\n  }\\n}\\nfunction handledragleave() {\\n  count++\\n  if (!(count % 2)) {\\n    console.log(\'\u79bb\u5f00\', count);\\n  }\\n}\\n```"},{"id":"fileDownload","metadata":{"permalink":"/blog/fileDownload","editUrl":"https://github.com/jonbenery/weblog/blog/2023-01-30-fileDownload/index.md","source":"@site/blog/2023-01-30-fileDownload/index.md","title":"\u524d\u7aef\u6587\u4ef6\u4e0b\u8f7d\u7684\u65b9\u5f0f","description":"1. a\u6807\u7b7e","date":"2023-01-30T00:00:00.000Z","formattedDate":"January 30, 2023","tags":[{"label":"javascript","permalink":"/blog/tags/javascript"}],"readingTime":8.32,"hasTruncateMarker":false,"authors":[{"name":"\u8d75\u9526\u5f6c","title":"coder javascript","url":"https://github.com/endiliey","imageURL":"https://github.com/endiliey.png","key":"jonben"}],"frontMatter":{"slug":"fileDownload","title":"\u524d\u7aef\u6587\u4ef6\u4e0b\u8f7d\u7684\u65b9\u5f0f","authors":"jonben","tags":["javascript"]},"prevItem":{"title":"\u591a\u5c42\u7ea7\u5143\u7d20\u62d6\u653e","permalink":"/blog/elementDrag"},"nextItem":{"title":"\u8ba1\u7b97\u56fe\u7247\u7b49\u6bd4\u7f29\u653e\u540e\u7684\u5bbd\u9ad8","permalink":"/blog/getImageRatio"}},"content":"## 1. a\u6807\u7b7e\\n\\n\u901a\u8fc7`a`\u6807\u7b7e\u7684`download`\u5c5e\u6027\u6765\u5b9e\u73b0\u6587\u4ef6\u4e0b\u8f7d\uff0c\u8fd9\u79cd\u65b9\u5f0f\u662f\u6700\u7b80\u5355\u7684\uff0c\u4e5f\u662f\u6211\u4eec\u6bd4\u8f83\u5e38\u7528\u7684\u65b9\u5f0f\uff0c\u5148\u6765\u770b\u793a\u4f8b\u4ee3\u7801\uff1a\\n\\n```js\\n<a href=\\"http://www.baidu.com\\" download=\\"baidu.html\\">\u4e0b\u8f7d</a>\\n```\\n\\n\u5c31\u4e0a\u9762\u7684\u8fd9\u4e2a\u793a\u4f8b\uff0c\u6211\u4eec\u70b9\u51fb\u4e0b\u8f7d\uff0c\u53d1\u73b0\u662f\u8df3\u8f6c\u5230\u4e86\u767e\u5ea6\u7684\u9996\u9875\uff0c\u5e76\u6ca1\u6709\u771f\u7684\u4e0b\u8f7d\u6587\u4ef6\u3002\\n\u56e0\u4e3aa\u6807\u7b7e\u4e0b\u8f7d\u53ea\u80fd\u4e0b\u8f7d\u540c\u6e90\u7684\u6587\u4ef6\uff0c\u5982\u679c\u662f\u8de8\u57df\u7684\u6587\u4ef6\uff0c\u8fd9\u91cc\u5305\u62ec\u56fe\u7247\u3001\u97f3\u89c6\u9891\u7b49\u5a92\u4f53\u6587\u4ef6\uff0c\u90fd\u662f\u9884\u89c8\uff0c\u4e5f\u65e0\u6cd5\u4e0b\u8f7d\u3002\\n\\n\u4e0a\u9762\u7684\u4ee3\u7801\u662f\u76f4\u63a5\u901a\u8fc7\u4e66\u5199a\u6807\u7b7e\u6765\u5b9e\u73b0\u6587\u4ef6\u4e0b\u8f7d\uff0c\u6211\u4eec\u4e5f\u53ef\u4ee5\u901a\u8fc7js\u6765\u5b9e\u73b0\uff0c\u4ee3\u7801\u5982\u4e0b\uff1a\\n\\n\\n```js\\nconst a = document.createElement(\'a\')\\na.href = \'http://www.baidu.com\'\\na.download = \'baidu.html\'\\na.click()\\n```\\n\\n\u6548\u679c\u548c\u4e0a\u9762\u7684\u4e00\u6837\uff0c\u90fd\u662f\u8df3\u8f6c\u5230\u767e\u5ea6\u7684\u9996\u9875\uff0c\u6ca1\u6709\u4e0b\u8f7d\u6587\u4ef6\u3002\\n\u8fd9\u91cc\u7684\u91cd\u70b9\u662f`a`\u6807\u7b7e\u7684`download`\u5c5e\u6027\uff0c\u8fd9\u4e2a\u5c5e\u6027\u662f`HTML5`\u65b0\u589e\u7684\u3002\\n\u5b83\u7684\u4f5c\u7528\u662f\u6307\u5b9a\u4e0b\u8f7d\u7684\u6587\u4ef6\u540d\uff0c\u5982\u679c\u4e0d\u6307\u5b9a\uff0c\u90a3\u4e48\u4e0b\u8f7d\u7684\u6587\u4ef6\u540d\u5c31\u4f1a\u6839\u636e\u8bf7\u6c42\u5185\u5bb9\u7684`Content-Disposition`\u6765\u786e\u5b9a\uff0c\u5982\u679c\u6ca1\u6709`Content-Disposition`\uff0c\u90a3\u4e48\u5c31\u4f1a\u4f7f\u7528\u8bf7\u6c42\u7684`URL`\u7684\u6700\u540e\u4e00\u90e8\u5206\u4f5c\u4e3a\u6587\u4ef6\u540d\u3002\\n\\n## 1. window.open\\n\\n\u4e0a\u9762\u4f7f\u7528a\u6807\u7b7e\u7684\u6848\u4f8b\u4e5f\u53ef\u4ee5\u901a\u8fc7window.open\u6765\u5b9e\u73b0\uff0c\u6548\u679c\u662f\u4e00\u6837\u7684\uff0c\u4ee3\u7801\u5982\u4e0b\uff1a\\n\\n```js\\nwindow.open(\'http://www.baidu.com\', \'_blank\')\\n```\\n\\n\u8fd9\u91cc\u7684`_blank`\u662f\u6307\u5b9a\u6253\u5f00\u7684\u65b9\u5f0f\uff0c\u5982\u679c\u4e0d\u6307\u5b9a\uff0c\u90a3\u4e48\u5c31\u4f1a\u5728\u5f53\u524d\u9875\u9762\u6253\u5f00\uff0c\u8fd9\u91cc\u6307\u5b9a`_blank`\uff0c\u5c31\u662f\u5728\u65b0\u7684\u9875\u9762\u6253\u5f00\u3002\\n\\n\u540c\u6837`a`\u6807\u7b7e\u7684`download`\u5c5e\u6027\u4e5f\u662f\u53ef\u4ee5\u4f7f\u7528\u7684\uff0c\u4ee3\u7801\u5982\u4e0b\uff1a\\n\\n```js\\nwindow.open(\'http://www.baidu.com\', \'_blank\', \'download=baidu.html\')\\n```\\n\u5f53\u7136\u8fd9\u79cd\u65b9\u5f0f\u4e5f\u662f\u6709\u7f3a\u9677\u7684\uff0c\u5bf9\u6bd4\u4e8e`a`\u6807\u7b7e\uff0c\u8fd9\u79cd\u65b9\u5f0f\u4e0d\u80fd\u4e0b\u8f7d``.html\u3001.htm\u3001.xml\u3001.xhtml`\u7b49\u6587\u4ef6\uff0c\u56e0\u4e3a\u8fd9\u4e9b\u6587\u4ef6\u4f1a\u88ab\u5f53\u6210`html`\u6587\u4ef6\u6765\u5904\u7406\uff0c\u6240\u4ee5\u4f1a\u76f4\u63a5\u5728\u5f53\u524d\u9875\u9762\u6253\u5f00\u3002\\n\u540c\u6837\u4e5f\u4e0d\u80fd\u4e0b\u8f7d\u8de8\u57df\u7684\u6587\u4ef6\uff0c\u6bd5\u7adf\u662f`window.open`\uff0c\u4e0d\u662f`window.download`\uff08`window.download`\u662f\u5047\u60f3\uff09\u3002\\n\\n## 3. location.href\\n\\n```js\\nlocation.href = \'http://www.baidu.com\'\\n```\\n\u8fd9\u79cd\u65b9\u5f0f\u62e5\u6709`window.open`\u7684\u6240\u6709\u7f3a\u9677\uff0c\u6240\u4ee5\u4e0d\u63a8\u8350\u4f7f\u7528\uff0c\u8fd9\u91cc\u53ea\u5f53\u4f5c\u4e86\u89e3\uff0c\u6240\u4ee5\u4e0d\u505a\u8fc7\u591a\u7684\u8bb2\u89e3\u3002\\n\\n## 4.  location.?\u5176\u4ed6\u5c5e\u6027\\n\u8fd9\u91cc\u7684\u5176\u4ed6\u6307\u4ee3\u7684\u90fd\u662f\u80fd\u8df3\u8f6c\u9875\u9762\u7684\u5c5e\u6027\uff0c\u6bd4\u5982`location.assign\u3001location.replace\u3001location.reload`\u7b49\uff0c\u8fd9\u4e9b\u5c5e\u6027\u90fd\u662f\u53ef\u4ee5\u5b9e\u73b0\u6587\u4ef6\u4e0b\u8f7d\u7684\uff0c\u4ee3\u7801\u5982\u4e0b\uff1a\\n```js\\nlocation.assign(\'http://www.baidu.com\')\\nlocation.replace(\'http://www.baidu.com\')\\nlocation.reload(\'http://www.baidu.com\')\\n```\\n\u8fd9\u91cc\u7684`location.reload`\u662f\u6709\u70b9\u7279\u6b8a\u7684\uff0c\u5b83\u7684\u4f5c\u7528\u662f\u91cd\u65b0\u52a0\u8f7d\u5f53\u524d\u9875\u9762\uff0c\u4f46\u662f\u5b83\u4e5f\u53ef\u4ee5\u63a5\u53d7\u4e00\u4e2a\u53c2\u6570\uff0c\u8fd9\u4e2a\u53c2\u6570\u5c31\u662f\u8981\u8df3\u8f6c\u7684\u9875\u9762\uff0c\u6240\u4ee5\u4e5f\u53ef\u4ee5\u5b9e\u73b0\u6587\u4ef6\u4e0b\u8f7d\u3002\\n\u5f53\u7136\u540c`location.href`\u4e00\u6837\uff0c\u8fd9\u4e9b\u65b9\u5f0f\u7684\u7f3a\u70b9\u90fd\u4e00\u6837\uff0c\u540c\u65f6\u8fd8\u6709\u5c5e\u4e8e\u6bcf\u4e2a\u5c5e\u6027\u81ea\u8eab\u7684\u7279\u6027\uff0c\u8fd9\u91cc\u53ea\u5f53\u62d3\u5c55\u77e5\u8bc6\uff0c\u4e0d\u505a\u8fc7\u591a\u7684\u8bb2\u89e3\u3002\\n\\n\\n## 5. XMLHttpRequest\\n\u8fd9\u79cd\u65b9\u5f0f\u5c31\u662f\u6211\u4eec\u5e38\u8bf4\u7684`ajax`\u4e0b\u8f7d\uff0c\u5305\u62ec`axios\u3001fetch`\u7b49\u90fd\u662f\u76f8\u540c\u7684\uff0c\u4ee3\u7801\u5982\u4e0b\uff1a\\n```js\\nconst xhr = new XMLHttpRequest()\\nxhr.open(\'GET\', \'http://www.baidu.com\')\\nxhr.send()\\n\\nxhr.onload = function () {\\n  const blob = new Blob([xhr.response], { type: \'text/html\' })\\n  const a = document.createElement(\'a\')\\n  a.href = URL.createObjectURL(blob)\\n  a.download = \'baidu.html\'\\n  a.click()\\n}\\n```\\n\u8fd9\u91cc\u5c31\u4e0d\u8bb2\u548c`XMLHttpRequest`\u76f8\u5173\u7684\u77e5\u8bc6\u4e86\uff0c\u53ea\u8bb2\u548c\u6587\u4ef6\u4e0b\u8f7d\u76f8\u5173\u7684\u90e8\u5206\u3002\\n\\n\u8fd9\u91cc\u4e3b\u8981\u7684\u903b\u8f91\u662f\u5f53\u6211\u4eec\u7684\u8bf7\u6c42\u6210\u529f\u540e\uff0c\u6211\u4eec\u4f1a\u62ff\u5230\u54cd\u5e94\u4f53\u7684`response`\uff0c\u8fd9\u4e2a`response`\u5c31\u662f\u6211\u4eec\u8981\u4e0b\u8f7d\u7684\u5185\u5bb9\uff0c\u7136\u540e\u6211\u4eec\u628a\u5b83\u8f6c\u6362\u6210`blob`\u5bf9\u8c61\uff0c\u7136\u540e\u901a\u8fc7`URL.createObjectURL`\u6765\u521b\u5efa\u4e00\u4e2a`url`\uff0c\u7136\u540e\u901a\u8fc7`a`\u6807\u7b7e\u7684`download`\u5c5e\u6027\u6765\u5b9e\u73b0\u6587\u4ef6\u4e0b\u8f7d\u3002\\n\\n\u8fd9\u91cc\u7684\u77e5\u8bc6\u70b9\u5c31\u6709\u4e24\u4e2a\uff0c\u4e00\u4e2a\u662f`blob`\u5bf9\u8c61\uff0c\u4e00\u4e2a\u662f`URL.createObjectURL`\u3002\\n\\n### 5.1. blob\\n\u4e0b\u9762\u662fblob\u5bf9\u8c61\u7684\u5b9a\u4e49\uff0c\u6765\u81ea[MDN](https://developer.mozilla.org/zh-CN/docs/Web/API/Blob)\uff1a\\n\\n:::info  MDN\\nBlob\u5bf9\u8c61\u8868\u793a\u4e00\u4e2a\u4e0d\u53ef\u53d8\u3001\u539f\u59cb\u6570\u636e\u7684\u7c7b\u6587\u4ef6\u5bf9\u8c61\u3002\u5b83\u7684\u6570\u636e\u53ef\u4ee5\u6309\u6587\u672c\u6216\u4e8c\u8fdb\u5236\u7684\u683c\u5f0f\u8fdb\u884c\u8bfb\u53d6\uff0c\u4e5f\u53ef\u4ee5\u8f6c\u6362\u6210 ReadableStream \u6765\u7528\u4e8e\u6570\u636e\u64cd\u4f5c\u3002\\nBlob\u8868\u793a\u7684\u4e0d\u4e00\u5b9a\u662fJavaScript\u539f\u751f\u683c\u5f0f\u7684\u6570\u636e\u3002File \u63a5\u53e3\u57fa\u4e8e Blob\uff0c\u7ee7\u627f\u4e86blob\u7684\u529f\u80fd\u5e76\u5c06\u5176\u6269\u5c55\u4ee5\u652f\u6301\u7528\u6237\u7cfb\u7edf\u4e0a\u7684\u6587\u4ef6\u3002\\n:::\\n\\n`blob`\u5bf9\u8c61\u662f`html5`\u65b0\u589e\u7684\u5bf9\u8c61\uff0c\u5b83\u7684\u4f5c\u7528\u662f\u7528\u6765\u5b58\u50a8\u4e8c\u8fdb\u5236\u6570\u636e\u7684\uff0c\u6bd4\u5982\u56fe\u7247\u3001\u89c6\u9891\u3001\u97f3\u9891\u7b49\uff0c\u5b83\u7684\u4f7f\u7528\u65b9\u6cd5\u5982\u4e0b\uff1a\\n```js\\n/**\\n * @param {Array} array \u4e8c\u8fdb\u5236\u6570\u636e\\n * @param {Object} options \u914d\u7f6e\u9879\\n *      @param {String} options.type \u6587\u4ef6\u7c7b\u578b\uff0c\u5b83\u4ee3\u8868\u4e86\u5c06\u4f1a\u88ab\u653e\u5165\u5230 blob \u4e2d\u7684\u6570\u7ec4\u5185\u5bb9\u7684 MIME \u7c7b\u578b\u3002\\n *      @param {String} options.endings \u7528\u4e8e\u6307\u5b9a\u5305\u542b\u884c\u7ed3\u675f\u7b26\\\\n\u7684\u5b57\u7b26\u4e32\u5982\u4f55\u88ab\u5199\u5165\u3002\u9ed8\u8ba4\u4e3atransparent\uff0c\u8868\u793a\u4e0d\u4f1a\u4fee\u6539\u884c\u7ed3\u675f\u7b26\u3002\u8fd8\u53ef\u4ee5\u6307\u5b9a\u4e3anative\uff0c\u8868\u793a\u4f1a\u5c06\\\\n\u8f6c\u6362\u4e3a\\\\r\\\\n\u3002\\n */\\nconst blob = new Blob([], { type: \'\' })\\n```\\n\u8fd9\u91cc\u4e3b\u8981\u5173\u6ce8\u7684\u662f`type`\u5c5e\u6027\uff0c\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c`blob`\u5bf9\u8c61\u662f\u6ca1\u6709`type`\u5c5e\u6027\u7684\uff0c\u90a3\u4e48\u8fd9\u4e2a`Blob`\u5c31\u662f\u4e00\u4e2a\u65e0\u7c7b\u578b\u7684`Blob`\uff0c\u6587\u4ef6\u4e0d\u4f1a\u635f\u6bc1\uff0c\u4f46\u662f\u65e0\u6cd5\u88ab\u6b63\u5e38\u8bc6\u522b\u3002\\n\\n\\n### 5.2 URL.createObjectURL\\n\u4e0b\u9762\u6765\u81ea[MDN](https://developer.mozilla.org/zh-CN/docs/Web/API/URL/createObjectURL)\uff1a\\n\\n:::info MDN\\nURL.createObjectURL() \u9759\u6001\u65b9\u6cd5\u4f1a\u521b\u5efa\u4e00\u4e2a DOMString\uff0c\u5176\u4e2d\u5305\u542b\u4e00\u4e2a\u8868\u793a\u53c2\u6570\u4e2d\u7ed9\u51fa\u7684\u5bf9\u8c61\u7684 URL\u3002\u8fd9\u4e2a URL \u7684\u751f\u547d\u5468\u671f\u548c\u521b\u5efa\u5b83\u7684\u7a97\u53e3\u4e2d\u7684 document \u7ed1\u5b9a\u3002\u8fd9\u4e2a\u65b0\u7684 URL \u5bf9\u8c61\u8868\u793a\u6307\u5b9a\u7684 File \u5bf9\u8c61\u6216 Blob \u5bf9\u8c61\u3002\\n:::\\n\\n\u8fd9\u4e2a\u65b9\u6cd5\u662f\u7528\u6765\u521b\u5efa\u4e00\u4e2a`url`\u7684\uff0c\u5b83\u7684\u4f5c\u7528\u662f\u628a\u4e00\u4e2a`blob`\u5bf9\u8c61\u8f6c\u6362\u6210\u4e00\u4e2a`url`\uff0c\u8fd9\u4e2a`url`\u53ef\u4ee5\u7528\u6765\u4e0b\u8f7d\u6587\u4ef6\uff0c\u4e5f\u53ef\u4ee5\u7528\u6765\u9884\u89c8\u6587\u4ef6\uff0c\u4ee3\u7801\u5982\u4e0b\uff1a\\n```js\\nconst url = URL.createObjectURL(blob)\\n```\\n\u8fd9\u91cc\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u8fd9\u4e2a`url`\u7684\u751f\u547d\u5468\u671f\u548c\u521b\u5efa\u5b83\u7684\u7a97\u53e3\u4e2d\u7684`document`\u7ed1\u5b9a\uff0c\u4e5f\u5c31\u662f\u8bf4\uff0c\u5f53\u6211\u4eec\u7684`document`\u88ab\u9500\u6bc1\u540e\uff0c\u8fd9\u4e2a`url`\u5c31\u4f1a\u5931\u6548\uff0c\u6240\u4ee5\u6211\u4eec\u9700\u8981\u5728\u5408\u9002\u7684\u65f6\u673a\u9500\u6bc1\u5b83\uff0c\u4ee3\u7801\u5982\u4e0b\uff1a\\n```js\\nURL.revokeObjectURL(url)\\n```\\n\\n\u56de\u5230\u6211\u4eec\u521a\u624d\u4e0b\u8f7d\u7684\u95ee\u9898\uff0c\u6211\u4eec\u662f\u901a\u8fc7`blob`\u5bf9\u8c61\u6765\u89e3\u51b3\uff0c\u4f46\u662f\u6211\u4eec\u7684`type`\u5c5e\u6027\u662f\u5199\u6b7b\u7684\uff0c\u5982\u679c\u5728\u6587\u4ef6\u7c7b\u578b\u662f\u786e\u5b9a\u7684\u60c5\u51b5\u4e0b\u662f\u6ca1\u95ee\u9898\u7684\uff0c\u4f46\u662f\u5982\u679c\u8fd9\u4e2a\u63a5\u53e3\u5c31\u662f\u4e0b\u8f7d\u6587\u4ef6\u7684\u63a5\u53e3\uff0c\u6587\u4ef6\u53ef\u80fd\u662f\u5404\u79cd\u7c7b\u578b\u7684\uff0c\u6211\u4eec\u5e94\u8be5\u600e\u4e48\u5904\u7406\uff1f\\n\\n\u8fd9\u91cc\u7684\u6ca1\u6709\u6b63\u786e\u7b54\u6848\uff0c\u7b2c\u4e00\u4e2a\u53ef\u4ee5\u548c\u63a5\u53e3\u63d0\u4f9b\u8005\u8fdb\u884c\u534f\u5546\uff0c\u534f\u5546\u65b9\u6848\u662f\u4e0d\u786e\u5b9a\u7684\uff0c\u7b2c\u4e8c\u5c31\u662f\u901a\u8fc7`response`\u7684`header`\u6765\u83b7\u53d6\u6587\u4ef6\u7684`type`\uff0c\u4e5f\u662f\u6211\u4eec\u8981\u8bb2\u7684\uff1a\\n```js\\nconst type = response.headers[\'content-type\']\\n\\nconst blob = new Blob([response.data], { type })\\n```\\n\\n\u8fd9\u91cc\u6211\u4eec\u901a\u8fc7`response`\u7684`header`\u6765\u83b7\u53d6`type`\uff0c\u7136\u540e\u518d\u521b\u5efa`blob`\u5bf9\u8c61\uff0c\u8fd9\u6837\u5c31\u53ef\u4ee5\u6b63\u786e\u7684\u4e0b\u8f7d\u6587\u4ef6\u4e86\u3002\\n\\n\u5176\u5b9e`content-type`\u4e5f\u53ef\u80fd\u662f`application/octet-stream`\uff0c\u8fd9\u4e2a\u65f6\u5019\u6211\u4eec\u5c31\u9700\u8981\u901a\u8fc7`file-type`\u6765\u83b7\u53d6\u6587\u4ef6\u7684`type`\u4e86\u3002\\n\\n\u4e0b\u9762\u7684\u4ee3\u7801\u662f\u901a\u8fc7`file-type`\u6765\u83b7\u53d6\u6587\u4ef6\u7684`type`\uff1a\\n\\n```js\\nimport {fileTypeFromStream} from \'file-type\';\\n\\nconst type = await fileTypeFromStream(response.body);\\nconst blob = new Blob([response.data], { type })\\n```\\nfile-type\u7684\u4f7f\u7528\u53ef\u4ee5\u53c2\u8003[file-type](https://github.com/sindresorhus/file-type\\n)\u3002"},{"id":"getImageRatio","metadata":{"permalink":"/blog/getImageRatio","editUrl":"https://github.com/jonbenery/weblog/blog/2023-01-30-getImageRatio/index.md","source":"@site/blog/2023-01-30-getImageRatio/index.md","title":"\u8ba1\u7b97\u56fe\u7247\u7b49\u6bd4\u7f29\u653e\u540e\u7684\u5bbd\u9ad8","description":"\u6839\u636e\u56fe\u7247\u7684\u5bbd\u5ea6\u7b49\u6bd4\u7f29\u653e\u56fe\u7247\u5230\u4e00\u5b9a\u7684\u6bd4\u4f8b\uff0c\u4ee3\u7801\u5982\u4e0b\uff1a","date":"2023-01-30T00:00:00.000Z","formattedDate":"January 30, 2023","tags":[{"label":"javascript","permalink":"/blog/tags/javascript"}],"readingTime":0.9,"hasTruncateMarker":false,"authors":[{"name":"\u8d75\u9526\u5f6c","title":"coder javascript","url":"https://github.com/endiliey","imageURL":"https://github.com/endiliey.png","key":"jonben"}],"frontMatter":{"slug":"getImageRatio","title":"\u8ba1\u7b97\u56fe\u7247\u7b49\u6bd4\u7f29\u653e\u540e\u7684\u5bbd\u9ad8","authors":"jonben","tags":["javascript"]},"prevItem":{"title":"\u524d\u7aef\u6587\u4ef6\u4e0b\u8f7d\u7684\u65b9\u5f0f","permalink":"/blog/fileDownload"},"nextItem":{"title":"\u83b7\u53d6\u4e00\u4e2a\u968f\u673a\u4e0d\u91cd\u590d\u7684\u5b57\u7b26\u4e32","permalink":"/blog/getRandomUid"}},"content":"\u6839\u636e\u56fe\u7247\u7684\u5bbd\u5ea6\u7b49\u6bd4\u7f29\u653e\u56fe\u7247\u5230\u4e00\u5b9a\u7684\u6bd4\u4f8b\uff0c\u4ee3\u7801\u5982\u4e0b\uff1a\\n```js\\nfunction getImgScaleRect(url, maxWidth = 200, maxHeight = 300) {\\n  // \u56fe\u7247\u7684\u5bbd\\n  let width = ((/imageHeight=(?<width>\\\\d+)/.exec(url) || {}).groups || {}).width;\\n  // \u56fe\u7247\u7684\u9ad8\\n  let height = ((/imageWidth=(?<height>\\\\d+)/.exec(url) || {}).groups || {}).height;\\n  // \u6bd4\u4f8b\\n  let b1 = width / maxWidth;\\n  let b2 = height / maxHeight;\\n  if (b1 <= 1 && b2 <= 1) {\\n    // width = width;\\n    // height = height;\\n  } else if (b1 <= 1 && b2 > 1) {\\n    width = width / b2;\\n    height = maxHeight;\\n  } else if (b1 > 1 && b2 <= 1) {\\n    width = maxWidth;\\n    height = height / b1;\\n  } else if (b1 > 1 && b2 > 1) {\\n    let b = b1 > b2 ? b1 : b2; // \u53d6\u6bd4\u4f8b\u5927\u7684\\n    width = width / b;\\n    height = height / b;\\n  }\\n  return {\\n    width: width + \'px\',\\n    height: height + \'px\'\\n  };\\n}\\n```"},{"id":"getRandomUid","metadata":{"permalink":"/blog/getRandomUid","editUrl":"https://github.com/jonbenery/weblog/blog/2023-01-30-getRandomUid/index.md","source":"@site/blog/2023-01-30-getRandomUid/index.md","title":"\u83b7\u53d6\u4e00\u4e2a\u968f\u673a\u4e0d\u91cd\u590d\u7684\u5b57\u7b26\u4e32","description":"1. \u81ea\u5df1\u5b9e\u73b0","date":"2023-01-30T00:00:00.000Z","formattedDate":"January 30, 2023","tags":[{"label":"javascript","permalink":"/blog/tags/javascript"}],"readingTime":0.405,"hasTruncateMarker":false,"authors":[{"name":"\u8d75\u9526\u5f6c","title":"coder javascript","url":"https://github.com/endiliey","imageURL":"https://github.com/endiliey.png","key":"jonben"}],"frontMatter":{"slug":"getRandomUid","title":"\u83b7\u53d6\u4e00\u4e2a\u968f\u673a\u4e0d\u91cd\u590d\u7684\u5b57\u7b26\u4e32","authors":"jonben","tags":["javascript"]},"prevItem":{"title":"\u8ba1\u7b97\u56fe\u7247\u7b49\u6bd4\u7f29\u653e\u540e\u7684\u5bbd\u9ad8","permalink":"/blog/getImageRatio"},"nextItem":{"title":"\u9f20\u6807\u7684\u62d6\u62fd\u6a21\u62df\u6eda\u52a8\u6761\u6eda\u52a8","permalink":"/blog/mousemoveSimulationScroll"}},"content":"### 1. \u81ea\u5df1\u5b9e\u73b0\\n\\n```js\\nfunction getGenUID() {\\n  let date = new Date().getTime();\\n  let uuid = \\"xxxxxx4xxxyxxxxxxx\\".replace(/[xy]/g, function (c) {\\n    let r = (date + Math.random() * 16) % 16 | 0;\\n    date = Math.floor(date / 16);\\n    return (c == \\"x\\" ? r : (r & 0x3) | 0x8).toString(16);\\n  });\\n  return uuid;\\n}\\n\\n```\\n\\n### 2. \u8fd8\u6709\u4e00\u4e2a\u975e\u5e38\u597d\u7528\u7684\u5e93`nanoid`\\n\\n```js\\nimport { nanoid } from \'nanoid\';\\nconst uid = nanoid();\\n```"},{"id":"mousemoveSimulationScroll","metadata":{"permalink":"/blog/mousemoveSimulationScroll","editUrl":"https://github.com/jonbenery/weblog/blog/2023-01-30-mousemoveSimulationScroll/index.md","source":"@site/blog/2023-01-30-mousemoveSimulationScroll/index.md","title":"\u9f20\u6807\u7684\u62d6\u62fd\u6a21\u62df\u6eda\u52a8\u6761\u6eda\u52a8","description":"\u76ee\u6807","date":"2023-01-30T00:00:00.000Z","formattedDate":"January 30, 2023","tags":[{"label":"javascript","permalink":"/blog/tags/javascript"}],"readingTime":2.845,"hasTruncateMarker":false,"authors":[{"name":"\u8d75\u9526\u5f6c","title":"coder javascript","url":"https://github.com/endiliey","imageURL":"https://github.com/endiliey.png","key":"jonben"}],"frontMatter":{"slug":"mousemoveSimulationScroll","title":"\u9f20\u6807\u7684\u62d6\u62fd\u6a21\u62df\u6eda\u52a8\u6761\u6eda\u52a8","authors":"jonben","tags":["javascript"]},"prevItem":{"title":"\u83b7\u53d6\u4e00\u4e2a\u968f\u673a\u4e0d\u91cd\u590d\u7684\u5b57\u7b26\u4e32","permalink":"/blog/getRandomUid"},"nextItem":{"title":"\u4e24\u4e2a\u5217\u8868\u533a\u57df\u540c\u6b65\u6eda\u52a8","permalink":"/blog/syncScrolling"}},"content":"### \u76ee\u6807\\n\u5f53\u9875\u9762\u51fa\u73b0\u6a2a\u5411\u6eda\u52a8\u6761\u7684\u65f6\u5019\uff0c\u60f3\u8981\u5de6\u53f3\u6eda\u52a8\u53ea\u80fd\u901a\u8fc7\u62d6\u52a8\u6eda\u52a8\u6761\u7684\u65b9\u5f0f\uff0c\u4e0d\u65b9\u4fbf\u7528\u6237\u64cd\u4f5c\uff0c\u8981\u5b9e\u73b0\u7684\u662f\u901a\u8fc7\u9f20\u6807\u7684\u62d6\u52a8\u5b9e\u73b0\u9875\u9762\u7684\u6a2a\u5411\u6eda\u52a8\\n\\n### \u539f\u7406\\n\u901a\u8fc7\u8bb0\u5f55\u9f20\u6807\u6309\u4e0b\u548c\u79fb\u52a8\u7684\u8ddd\u79bb\u8bbe\u7f6e\u6eda\u52a8\u6761\u7684\u6eda\u52a8\u8ddd\u79bb\\n\\n### \u5b9e\u73b0\\n\\n* \u5e26\u963b\u5c3c\u611f\u7684\u62d6\u52a8\uff0c\u66f4\u597d\u7684\u6a21\u62df\u539f\u751f\u6eda\u52a8\\n```js\\nfunction mouseMoveSimulationScroll(el) {\\n  if (!el) return\\n  let startScroll = 0;\\n  let startX = 0;\\n  let previousX = 0; // \u4fdd\u5b58\u4e0a\u4e00\u6b21\u7684clientX\u5750\u6807\\n  let currentX = 0; // \u83b7\u53d6\u6bcf\u6b21\u79fb\u52a8\u7684\u4f4d\u7f6e\\n  let velocity = 0; // \u63a7\u5236\u901f\u5ea6\\n  let direction = 0; // \u63a7\u5236\u5de6\u53f3\u6ed1\u52a8\\n  let momentum = 0.875; // \u63a7\u5236\u6ed1\u52a8\u8ddd\u79bb\\n  let momentumInterval = null;\\n  let velocityInterval = null;\\n  el.onmousedown = function (event) {\\n    startScroll = el.scrollLeft;\\n    startX = event.clientX;\\n    previousX = startX;\\n    currentX = startX;\\n    clearInterval(velocityInterval);\\n    velocityInterval = setInterval(function () {\\n      // previousX\u4fdd\u5b58\u4e0a\u4e00\u6b21\u79fb\u52a8\u9f20\u6807\u7684clientX\u503c\\n      // \u6162\u901f\u79fb\u52a8\u65f6currentX\u4e0epreviousX\u6570\u503c\u76f8\u540c\u6216\u8005\u5dee\u503c\u8f83\u5c0f\uff08\u6162\u901f\u79fb\u52a8\u9f20\u6807\u4e00\u76f4\u5728\u4e00\u4e2a\u70b9\u4e0a\uff09\\n      // \u5feb\u901f\u6ed1\u52a8\u65f6\u9f20\u6807\u5de6\u6ed1previousX\u5927\u4e8ecurrentX\uff0c\u53f3\u6ed1currentX\u5927\u4e8epreviousX\\n      // \u539f\u7406\uff1a\u5f53\u5feb\u901f\u79fb\u52a8\u65f6\uff0c\u677e\u5f00\u9f20\u6807\u7684\u65f6\u5019\u5df2\u7ecf\u4e0d\u5728\u5f53\u65f6\u70b9\u51fb\u7684\u70b9\u4f4d\u4e0a\uff0c50\u6beb\u79d2\u540e\u5c31\u51fa\u73b0\u4e862\u4e2a\u53d8\u91cf\u7684\u6570\u503c\u5dee\\n      // \u539f\u56e0\uff1a\u9f20\u6807\u79fb\u52a8\u65f6\uff0c\u4e0d\u4f1a\u5b58\u50a8\u6240\u6709\u7684\u79fb\u52a8\u4fe1\u606f\u3002\u5c24\u5176\u662f\u5728\u5feb\u901f\u79fb\u52a8\u9f20\u6807\u65f6\\n      velocity = Math.abs(currentX - previousX);\\n      // \u6b63\u8d1f\u6570\u8f6c\u6362\u7528\u4e8e\u63a7\u5236\u5de6\u53f3\u6ed1\u52a8\\n      // \u5de6\u6ed1\u52a8\u4e3a\u6b63\u6570\uff0c\u53f3\u6ed1\u52a8\u4e3a\u8d1f\u6570\\n      direction = currentX > previousX ? -1 : 1;\\n\\n      previousX = currentX;\\n    }, 50);\\n    el.onmousemove = function(event) {\\n      currentX = event.clientX;\\n      el.scrollLeft = startScroll + (startX - currentX);\\n    }\\n    el.onmouseleave = function () {\\n      el.onmousemove = null\\n    };\\n    el.onmouseup = function () {\\n      let num = 0;\\n      clearInterval(velocityInterval);\\n      clearInterval(momentumInterval);\\n      num = velocity;\\n      // \u9f20\u6807\u677e\u5f00\u540e\u5f00\u59cb\u6267\u884c\u6ed1\u52a8\\n      momentumInterval = setInterval(function () {\\n        // \u6ed1\u52a8\u8ddd\u79bb\u4f9d\u6b21\u51cf\u5c0f\\n        el.scrollLeft = el.scrollLeft + num * direction;\\n        // \u6570\u503c\u4f9d\u6b21\u51cf\u5c0f\\n        num *= momentum;\\n        // \u5c0f\u4e8e1\u9500\u6bc1\u5b9a\u65f6\u5668\uff0c\u6ed1\u52a8\u7ed3\u675f\\n        if (Math.abs(num) < 1) {\\n          clearInterval(momentumInterval);\\n        }\\n      }, 15);\\n      el.onmousemove = null\\n      el.onmouseleave = null\\n      el.onmouseup = null\\n    };\\n  };\\n\\n}\\n\\n```\\n\\n* \u4ec5\u4ec5\u662f\u62d6\u52a8\uff0c\u7b80\u5355\u7684\u5b9e\u73b0\\n```js\\nfunction handlemousedownControlScroll(evt, el) {\\n  const scrollLeft = el.scrollLeft\\n  const startPos = evt.clientX\\n  document.onmouseup = function() {\\n    document.onmousemove = null\\n  }\\n  document.onmouseleave = function() {\\n    document.onmousemove = null\\n  }\\n  if (evt.which === 3) {\\n    document.onmousemove = function(e) {\\n      el.scrollLeft = scrollLeft + (startPos - e.clientX)\\n    }\\n  }\\n}\\n\\n```"},{"id":"syncScrolling","metadata":{"permalink":"/blog/syncScrolling","editUrl":"https://github.com/jonbenery/weblog/blog/2023-01-30-syncScrolling/index.md","source":"@site/blog/2023-01-30-syncScrolling/index.md","title":"\u4e24\u4e2a\u5217\u8868\u533a\u57df\u540c\u6b65\u6eda\u52a8","description":"\u76ee\u6807","date":"2023-01-30T00:00:00.000Z","formattedDate":"January 30, 2023","tags":[{"label":"javascript","permalink":"/blog/tags/javascript"}],"readingTime":2.535,"hasTruncateMarker":false,"authors":[{"name":"\u8d75\u9526\u5f6c","title":"coder javascript","url":"https://github.com/endiliey","imageURL":"https://github.com/endiliey.png","key":"jonben"}],"frontMatter":{"slug":"syncScrolling","title":"\u4e24\u4e2a\u5217\u8868\u533a\u57df\u540c\u6b65\u6eda\u52a8","authors":"jonben","tags":["javascript"]},"prevItem":{"title":"\u9f20\u6807\u7684\u62d6\u62fd\u6a21\u62df\u6eda\u52a8\u6761\u6eda\u52a8","permalink":"/blog/mousemoveSimulationScroll"}},"content":"### \u76ee\u6807\\n\u9875\u9762\u4e2d\u6709\u4e24\u4e2a\u5217\u8868\u5143\u7d20\uff0c\u5176\u4e2d\u4e00\u4e2a\u5143\u7d20\u7684\u6eda\u52a8\u8981\u548c\u4e00\u4e2a\u5143\u7d20\u7684\u6eda\u52a8\u540c\u6b65\\n\\n### \u539f\u7406\\n * \u76d1\u542c\u5143\u7d20\u5bf9\u8c61\u7684\u6eda\u52a8\u6761\u4e8b\u4ef6\\n```js\\nvar box = document.getElementById(\'box\') // \u83b7\u53d6id\u4e3abox\u7684\u5143\u7d20\\nbox.onscroll = function() {\\n    // box\u7684\u6eda\u52a8\u6761\u6eda\u52a8\u65f6\u89e6\u53d1\\n}\\n\\n```\\n* \u6eda\u52a8\u6761\u7684\u5c5e\u6027\\n```js\\n// \u5782\u76f4\u6eda\u52a8\u6761\\nbox.scrollHeight // \u53ef\u6eda\u52a8\u7684\u9ad8\u5ea6\\nbox.clientHeight // \u6ed1\u5757\u7684\u9ad8\u5ea6\\nbox.scrollTop // \u5df2\u7eb5\u5411\u6eda\u52a8\u7684\u8ddd\u79bb\\n// \u6c34\u5e73\u6eda\u52a8\u6761\\nbox.scrollWidth // \u53ef\u6eda\u52a8\u7684\u5bbd\u5ea6\\nbox.clientWidth // \u6ed1\u5757\u7684\u5bbd\u5ea6\\nbox.scrollLeft // \u5df2\u6a2a\u5411\u6eda\u52a8\u7684\u8ddd\u79bb\\n\\n```\\n\\n### \u601d\u8def\\n\u76d1\u542c\u7b2c\u4e00\u4e2a\u6eda\u52a8\u6761\uff0c\u5f53\u6eda\u52a8\u6761\u6eda\u52a8\u65f6\uff0c\u83b7\u53d6\u7b2c\u4e00\u4e2a\u6eda\u52a8\u6761\u7684\u4f4d\u7f6e\uff0c\u7136\u540e\u6539\u53d8\u7b2c\u4e8c\u4e2a\u6eda\u52a8\u6761\u7684\u4f4d\u7f6e\uff1b\\n\u76d1\u542c\u7b2c\u4e8c\u4e2a\u6eda\u52a8\u6761\uff0c\u5f53\u6eda\u52a8\u6761\u6eda\u52a8\u65f6\uff0c\u83b7\u53d6\u7b2c\u4e8c\u4e2a\u6eda\u52a8\u6761\u7684\u4f4d\u7f6e\uff0c\u7136\u540e\u6539\u53d8\u7b2c\u4e00\u4e2a\u6eda\u52a8\u6761\u7684\u4f4d\u7f6e\u3002\\n\\n### \u5b9e\u73b0\\n```js\\nlet first = document.getElementById(\'first\')\\nlet second = document.getElementById(\'second\')\\nfirst.onscroll = () => {\\n  second.scrollTop = first.scrollTop / (first.scrollHeight - first.clientHeight) * (second.scrollHeight - second.clientHeight) // \u6309\u767e\u5206\u6bd4\u540c\u6b65\u4f4d\u7f6e\\n}\\nsecond.onscroll = () => {\\n  first.scrollTop = second.scrollTop / (second.scrollHeight - second.clientHeight) * (first.scrollHeight - first.clientHeight)\\n}\\n\\n\\n```\\n### \u51fa\u73b0\u7684\u95ee\u9898\\n\u7531\u4e8e\u7b2c\u4e00\u4e2a\u5143\u7d20\u6eda\u52a8\u65f6\u89e6\u53d1\u4e86\u7b2c\u4e8c\u4e2a\u5143\u7d20\u7684\u6eda\u52a8\uff0c\u4e24\u4e2a\u5143\u7d20\u7684\u6eda\u52a8\u88ab\u76f8\u4e92\u5236\u7ea6\\n\\n### \u4fee\u590d\u95ee\u9898\\n\u4e8e\u662f\uff0c\u6211\u4f7f\u7528\u4e24\u4e2a\u53d8\u91cffirstchange\u548csecondchange\u5206\u522b\u8868\u793a\u5141\u8bb8\u7b2c\u4e00\u4e2a\u5143\u7d20\u6eda\u52a8\u548c\u5141\u8bb8\u7b2c\u4e8c\u4e2a\u5143\u7d20\u6eda\u52a8\uff1b\\n\u5f53\u7b2c\u4e00\u4e2a\u5143\u7d20\u9996\u5148\u89e6\u53d1\u6eda\u52a8\u65f6\uff0c\u8bbe\u7f6esecondchange\u4e3afalse\uff1b\\n\u7b2c\u4e8c\u4e2a\u5143\u7d20\u89e6\u53d1\u65f6\uff0c\u6839\u636esecondchange\uff0c\u4e0d\u5bf9\u5143\u7d20\u8fdb\u884c\u6eda\u52a8\uff0c\u7136\u540e\u5c06\u8bbe\u7f6esecondchange\u8bbe\u7f6e\u56detrue\uff0c\u5b8c\u6210\u4e00\u6b21\u540c\u6b65\u6eda\u52a8\u3002\\n\u7b2c\u4e8c\u4e2a\u5143\u7d20\u9996\u5148\u89e6\u53d1\u6eda\u52a8\u65f6\u7c7b\u4f3c\u3002\\n\\n### \u6700\u7ec8\u7ed3\u679c\\n```js\\nlet first = document.getElementById(\'first\')\\nlet second = document.getElementById(\'second\')\\nlet firstchange = true\\nlet secondchange = true\\nfirst.onscroll = () => {\\n  if (firstchange) {\\n    second.scrollTop = first.scrollTop / (first.scrollHeight - first.clientHeight) * (second.scrollHeight - second.clientHeight)\\n    secondchange = false\\n  } else {\\n    firstchange = true\\n  }\\n}\\nsecond.onscroll = () => {\\n  if (secondchange) {\\n    first.scrollTop = second.scrollTop / (second.scrollHeight - second.clientHeight) * (first.scrollHeight - first.clientHeight)\\n    firstchange = false\\n  } else {\\n    secondchange = true\\n  }\\n}\\n\\n```"}]}')}}]);